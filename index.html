<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>Memory of Pecotiita</title>
    <link rel="icon" href="images/favicon.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap');
        
        * { cursor: url('images/cursor.png') 16 16, auto !important; box-sizing: border-box; }

        body {
            background-color: #0d1117;
            color: #e6edf3;
            font-family: 'Noto Sans JP', sans-serif;
            margin: 0;
            display: flex; flex-direction: column; align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            -webkit-tap-highlight-color: transparent;
        }

        /* ----------------------------------------------------
           [ë¯¸ë‹ˆ LP í”Œë ˆì´ì–´]
           ---------------------------------------------------- */
        .mini-player-wrapper {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 200px;
            height: 200px;
            z-index: 9000;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.6);
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: #000;
        }
        .mini-player-wrapper:hover { transform: scale(1.05); border-color: #FFD700; }

        .player-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            background: radial-gradient(circle, transparent 30%, rgba(0,0,0,0.4) 100%);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
            z-index: 2;
        }

        .player-controls {
            position: absolute; bottom: 10px; left: 0; width: 100%;
            display: flex; justify-content: center; gap: 15px;
            z-index: 3;
        }
        .ctrl-btn {
            background: rgba(0,0,0,0.6); color: #fff; border: 1px solid rgba(255,255,255,0.2);
            width: 36px; height: 36px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; backdrop-filter: blur(4px); transition: 0.2s;
            font-size: 14px;
        }
        .ctrl-btn:hover { background: #FFD700; color: #000; border-color: #FFD700; }
        .music-on { color: #FFD700; border-color: #FFD700; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(255, 215, 0, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); } }

        @media (max-width: 768px) {
            .mini-player-wrapper { width: 160px; height: 160px; bottom: 15px; right: 15px; }
        }

        /* ----------------------------------------------------
           [ë°°ê²½ ë° ê¸°ë³¸ ë ˆì´ì•„ì›ƒ]
           ---------------------------------------------------- */
        .side-banner {
            position: absolute; top: 0; width: 300px; height: 100%; z-index: 0; 
            opacity: 0.15; filter: grayscale(80%) blur(3px) contrast(1.2);
            pointer-events: none; background-repeat: no-repeat; background-size: 100% auto;
        }
        .side-left { left: 0; background-image: url('images/chat_left.png'); -webkit-mask-image: linear-gradient(to right, rgba(0,0,0,1) 50%, rgba(0,0,0,0)); }
        .side-right { right: 0; background-image: url('images/chat_right.png'); -webkit-mask-image: linear-gradient(to left, rgba(0,0,0,1) 50%, rgba(0,0,0,0)); }

        .bg-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at top, rgba(13, 17, 23, 0.3) 0%, rgba(13, 17, 23, 1) 85%);
        }

        #floating-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 2; }
        .floating-item { position: absolute; opacity: 0.2; animation: floatUp linear infinite; }
        @keyframes floatUp { from { transform: translateY(105vh) rotate(0deg); } to { transform: translateY(-10vh) rotate(360deg); } }
        
        .trail-emoji { position: absolute; pointer-events: none; font-size: 24px; z-index: 9999; animation: fadeOut 1s forwards; }
        @keyframes fadeOut { 0% { opacity: 1; transform: translate(-50%, -50%) scale(1); } 100% { opacity: 0; transform: translate(-50%, 20px) scale(0.5); } }

        .container { width: 100%; max-width: 1000px; padding: 60px 20px; box-sizing: border-box; z-index: 1; margin-bottom: 80px; }
        .header-section { text-align: center; margin-bottom: 50px; }
        h1 { 
            color: #ffffff; font-size: 3rem; margin-bottom: 15px; font-weight: 800; 
            text-shadow: 0 0 40px rgba(255, 215, 0, 0.25); letter-spacing: -1px; word-break: keep-all;
        }
        
        .sub-message { color: #d0d7de; font-size: 1.1rem; line-height: 1.6; font-weight: 400; opacity: 1; word-break: keep-all; }
        .micro-copy { display: block; margin-top: 8px; font-size: 0.9rem; color: #8b949e; font-weight: 300; }
        .divider { width: 100px; height: 1px; background: linear-gradient(90deg, transparent, #b8860b, transparent); margin: 30px auto 40px; opacity: 0.6; }

        /* í†µê³„ ì¹´ë“œ */
        .stats-container { display: flex; justify-content: center; gap: 20px; margin-bottom: 40px; flex-wrap: wrap; }
        .stat-card {
            position: relative; overflow: hidden;
            background: linear-gradient(145deg, rgba(255,255,255,0.07) 0%, rgba(255,255,255,0.02) 100%);
            border-radius: 16px; padding: 30px 20px; text-align: center; 
            min-width: 220px; flex: 1;
            backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.4);
        }
        .stat-card::after {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 2px;
            background: linear-gradient(90deg, #2E7D32, #F57C00);
            box-shadow: 0 0 15px rgba(245, 124, 0, 0.4);
        }
        .card-icon { position: absolute; bottom: -10px; right: -10px; font-size: 5rem; opacity: 0.06; filter: grayscale(100%); pointer-events: none; transform: rotate(-15deg); }

        .stat-value, .date-value { 
            font-size: 2.5rem; font-weight: 900; display: block; margin-bottom: 10px; color: #ffffff;
            text-shadow: 0 0 10px rgba(46, 125, 50, 0.6), 0 0 20px rgba(245, 124, 0, 0.4);
            font-variant-numeric: tabular-nums; letter-spacing: -1px;
            animation: heartbeat 3s ease-in-out infinite;
        }
/* ì‚¬ë‘ìŠ¤ëŸ¬ìš´ ìˆ¨ì‰¬ê¸° ì• ë‹ˆë©”ì´ì…˜ (í•˜ë‚˜ë¡œ í†µí•©) */
        .stat-value { 
            animation: heartbeat 3s ease-in-out infinite; 
        }
        
        /* .date-valueì—ë„ ì• ë‹ˆë©”ì´ì…˜ì„ ì£¼ê³  ì‹¶ë‹¤ë©´ animation: none;ì„ ì§€ìš°ì„¸ìš” */
        .date-value { 
            font-size: 1.6rem; 
            margin-top: 8px; 
            animation: none; /* ë‚ ì§œëŠ” ì›€ì§ì´ì§€ ì•Šê²Œ ê³ ì •ë¨ */
        }

        /* [ì¤‘ìš”] ì¤‘ë³µ ì œê±° í›„, ê·¸ë¦¼ì íš¨ê³¼ê°€ ìˆëŠ” ë²„ì „ë§Œ ìœ ì§€ */
        @keyframes heartbeat {
            0% { transform: scale(1); }
            50% { 
                transform: scale(1.03); 
                /* í•˜ì–—ê³  ë½€ì–€ ë¹› ë²ˆì§ íš¨ê³¼ */
                filter: drop-shadow(0 0 15px rgba(255,255,255,0.5)); 
            }
            100% { transform: scale(1); }
        }

        .stat-label { 
            font-size: 0.9rem; color: #8b949e; font-weight: 500; 
            letter-spacing: 0.5px; text-transform: uppercase; 
        }
        
        .sparkle { 
            position: absolute; top: 10px; left: 10px; 
            font-size: 20px; opacity: 0; pointer-events: none; 
        }
        
        .sparkle.animate { animation: sparklePop 1s ease-out forwards; }
        
        @keyframes sparklePop { 
            0% { opacity: 0; transform: scale(0); } 
            50% { opacity: 1; transform: scale(1.2); } 
            100% { opacity: 0; transform: scale(0); } 
        }

        /* ì•¨ë²” ìŠ¬ë¼ì´ë” */
        .album-section { position: relative; width: 100%; max-width: 800px; margin: 0 auto 80px; }
        .album-container {
            overflow: hidden; border-radius: 16px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.5); border: 1px solid #30363d;
            background: #000; aspect-ratio: 16/9; position: relative;
        }
        .album-track { display: flex; transition: transform 0.5s ease-in-out; height: 100%; }
        .album-slide { min-width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; position: relative; }
        .album-slide img { width: 100%; height: 100%; object-fit: contain; }
        .album-caption {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: #fff; padding: 15px; text-align: center; font-size: 1rem; font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.7);
        }
        .album-btn {
            position: absolute; top: 50%; transform: translateY(-50%);
            background: rgba(0,0,0,0.3); color: #fff; border: none; font-size: 1.5rem;
            padding: 10px; cursor: pointer; border-radius: 50%; transition: 0.2s; z-index: 10;
            backdrop-filter: blur(3px);
        }
        .album-btn:hover { background: rgba(255, 215, 0, 0.8); color: #000; }
        .prev-btn { left: 10px; } .next-btn { right: 10px; }

        /* íˆíŠ¸ë§µ */
        #heatmap-section { width: 100%; margin-bottom: 100px; text-align: center; }
        .heatmap-tabs { display: flex; justify-content: center; gap: 8px; margin-bottom: 20px; flex-wrap: wrap; }
        .tab-btn {
            background: transparent; border: 1px solid rgba(255, 255, 255, 0.2);
            color: #8b949e; padding: 8px 16px; border-radius: 20px; cursor: pointer;
            font-size: 0.9rem; font-family: 'Noto Sans JP', sans-serif; transition: 0.3s; /* í°íŠ¸ ìˆ˜ì • ë¶€ë¶„ */
        }
        .tab-btn:hover { border-color: #FFD700; color: #fff; }
        .tab-btn.active {
            background: linear-gradient(135deg, #2E7D32, #F57C00);
            border: none; color: #fff; font-weight: bold; box-shadow: 0 0 10px rgba(245, 124, 0, 0.4);
        }
        #heatmap-chart {
            width: 100%; min-height: 240px; 
            background: rgba(22, 27, 34, 0.5); 
            border-radius: 16px; border: 1px solid #30363d; margin: 0 auto;
        }

        /* ----------------------------------------------------
           [NEW] í•€í„°ë ˆìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ í†µí•© ê°¤ëŸ¬ë¦¬ (Masonry)
           ---------------------------------------------------- */
        .gallery-container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto 80px; /* ì„¹ì…˜ ê°„ ê°„ê²© */
            padding: 0 10px;
        }

        .masonry-wall {
            column-count: 3; /* PC: 3ì¤„ */
            column-gap: 15px;
        }

        .art-card {
            display: inline-block; /* ë²½ëŒ ë°°ì¹˜ë¥¼ ìœ„í•´ í•„ìˆ˜ */
            width: 100%;
            margin-bottom: 15px;
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .art-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.4); /* ê¸ˆë¹› í•˜ì´ë¼ì´íŠ¸ */
            z-index: 10;
        }

        .art-card img {
            width: 100%;
            height: auto;
            display: block;
        }

        .art-info {
            padding: 12px 15px;
            background: linear-gradient(to bottom, #fff 0%, #f8f9fa 100%);
        }

        .art-title {
            font-size: 0.95rem;
            font-weight: 800;
            color: #333;
            margin-bottom: 4px;
        }

        .art-author {
            font-size: 0.8rem;
            color: #666;
            display: flex; align-items: center; gap: 5px;
        }

        /* êµ¬ë¶„ì„  ë””ìì¸ */
        .section-divider {
            width: 100%; max-width: 600px; height: 1px;
            background: linear-gradient(90deg, transparent, #FFD700, transparent);
            margin: 60px auto; opacity: 0.5;
        }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ (2ì¤„) */
        @media (max-width: 768px) {
            .masonry-wall { column-count: 2; }
            .art-title { font-size: 0.85rem; }
            .art-author { font-size: 0.75rem; }
        }

        /* ë¹„ë””ì˜¤ ëª¨ë‹¬ */
        #video-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; backdrop-filter: blur(8px); }
        #video-container { width: 95%; max-width: 1000px; aspect-ratio: 16/9; }
        iframe, video { width: 100%; height: 100%; border: none; border-radius: 12px; }
        .close-btn { margin-top: 20px; padding: 10px 30px; background: #FFD700; border: none; font-weight: bold; border-radius: 30px; cursor: pointer; }

        @media (max-width: 768px) {
            .container { padding: 40px 15px; }
            .side-banner { opacity: 0.08; } 
            h1 { font-size: 2rem; margin-bottom: 10px; }
            .sub-message { font-size: 0.95rem; }
            .stats-container { gap: 15px; flex-direction: column; }
            .stat-card { width: 100%; min-width: auto; padding: 25px 20px; }
            .tab-btn { padding: 6px 12px; font-size: 0.85rem; }
            .polaroid { width: 90%; max-width: 300px; }
            .notes-grid { gap: 10px; }
            .note { width: 45%; height: 140px; }
        }
        /* [NEW] íˆíŠ¸ë§µ ì„¹ì…˜ íƒ€ì´í‹€ (í•˜ì–—ê³  ë¹›ë‚˜ëŠ” íš¨ê³¼) */
        .section-title {
            font-size: 2rem; 
            font-weight: 800; 
            color: #ffffff; 
            margin-bottom: 25px;
            text-align: center;
            /* ì•…ì–´ê·¸ë¦° & ë‹¹ê·¼ì˜¤ë Œì§€ í›„ê´‘ íš¨ê³¼ */
            text-shadow: 
                0 0 10px rgba(46, 125, 50, 0.6), 
                0 0 20px rgba(245, 124, 0, 0.4);
        }
        
        .section-sub-title {
            font-size: 0.6em; 
            opacity: 0.7; 
            font-weight: 400; 
            margin-left: 8px;
            text-shadow: none; /* ì‘ì€ ê¸€ì”¨ëŠ” ê·¸ë¦¼ì ì œê±°í•´ì„œ ê°€ë…ì„± í™•ë³´ */
        }

/* [NEW] ìƒë‹¨ ë§ˆìŒ ì „í•˜ê¸° ë²„íŠ¼ ìœ„ì¹˜ */
        .love-container-top {
            margin-top: 40px; /* í†µê³„ ì¹´ë“œì™€ì˜ ê°„ê²© */
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            position: relative;
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ê¸°ì¡´ ìœ ì§€ + ì—…ê·¸ë ˆì´ë“œ) */
        .carrot-btn {
            background: linear-gradient(135deg, #FFD700, #FFA500); 
            color: #000; border: none;
            padding: 15px 40px; font-size: 1.2rem; font-weight: 800; border-radius: 50px;
            box-shadow: 0 8px 25px rgba(255, 165, 0, 0.4); 
            transition: transform 0.1s, box-shadow 0.2s;
            cursor: pointer; position: relative; overflow: visible; /* ì´ëª¨ì§€ íŠ€ì–´ë‚˜ì˜´ í—ˆìš© */
        }
        .carrot-btn:active { transform: scale(0.95); box-shadow: 0 4px 10px rgba(255, 165, 0, 0.4); }

        /* [NEW] íŒì—… ì´ëª¨ì§€ íš¨ê³¼ (ì„¸ë ¨ëœ ì›€ì§ì„) */
        .pop-emoji {
            position: absolute;
            pointer-events: none;
            font-size: 1.5rem;
            z-index: 100;
            animation: popUpFloat 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        @keyframes popUpFloat {
            0% {
                opacity: 0;
                transform: translate(-50%, 0) scale(0.5) rotate(0deg);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -40px) scale(1.2) rotate(10deg);
            }
            100% {
                opacity: 0;
                transform: translate(calc(-50% + var(--x-move)), -150px) scale(1) rotate(var(--rot));
            }
        }
/* ë°©ëª…ë¡ ì„¹ì…˜ */
        .message-section {
            width: 100%; max-width: 800px; margin: 0 auto 150px; padding: 0 10px;
        }

        /* ì…ë ¥ì°½ ë””ìì¸ */
        .input-container {
            display: flex; gap: 10px; justify-content: center; margin-bottom: 40px;
            flex-wrap: wrap;
        }
        .input-container input {
            padding: 12px; border-radius: 8px; border: 1px solid #444;
            background: #161b22; color: #fff; outline: none;
            font-family: 'Noto Sans JP', 'Pretendard', sans-serif;
        }
        #msg-name { width: 80px; text-align: center; }
        #msg-content { flex: 1; min-width: 200px; }
        
        #msg-send-btn {
            background: #FFD700; color: #000; border: none; padding: 0 20px;
            border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.2s;
        }
        #msg-send-btn:hover { background: #ffea70; transform: scale(1.05); }

        /* í¬ìŠ¤íŠ¸ì‡ ë©”ëª¨ ì¹´ë“œ */
        .msg-card {
            display: inline-block; width: 100%; margin-bottom: 15px;
            background: #fff; color: #333;
            padding: 15px; border-radius: 12px 0 12px 0; /* ì¢…ì´ ì ‘íŒ ëŠë‚Œ */
            box-shadow: 2px 2px 10px rgba(0,0,0,0.3);
            position: relative; break-inside: avoid;
            animation: fadeIn 0.5s ease-out;
        }
        
        .msg-header { 
            font-size: 0.8rem; color: #666; margin-bottom: 8px; font-weight: bold; 
            border-bottom: 1px dashed #ccc; padding-bottom: 5px;
            display: flex; justify-content: space-between;
        }
        .msg-body { font-size: 0.95rem; line-height: 1.4; word-break: break-all; }
        .msg-date { font-size: 0.7rem; color: #999; font-weight: normal; }

        /* í¬ìŠ¤íŠ¸ì‡ ìƒ‰ìƒ ëœë¤ íš¨ê³¼ (JSì—ì„œ í´ë˜ìŠ¤ ë¶€ì—¬) */
        .note-yellow { background: #fff9c4; }
        .note-blue { background: #e1f5fe; }
        .note-pink { background: #f8bbd0; }
        .note-green { background: #c8e6c9; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ------------------------------------------------
           [NEW] ê´€ë¦¬ì & ì‚­ì œ ê¸°ëŠ¥ ìŠ¤íƒ€ì¼
           ------------------------------------------------ */
        
/* 1. ê´€ë¦¬ì ë¡œê·¸ì¸ ë²„íŠ¼ (ìœ„ì¹˜ ìˆ˜ì •: ì˜¤ë¥¸ìª½ ìƒë‹¨) */
        .admin-gear {
            position: fixed; 
            top: 20px;      /* ë°”ë‹¥(bottom) ëŒ€ì‹  ìœ„(top)ë¡œ ë³€ê²½ */
            right: 20px;    /* ì™¼ìª½(left) ëŒ€ì‹  ì˜¤ë¥¸ìª½(right)ìœ¼ë¡œ ë³€ê²½ */
            
            font-size: 24px; 
            cursor: pointer; 
            opacity: 0.3; 
            z-index: 9999; 
            transition: 0.3s;
            color: #fff;    /* ì–´ë‘ìš´ ë°°ê²½ì—ì„œ ì˜ ë³´ì´ê²Œ í°ìƒ‰ ì¶”ê°€ */
        }
        .admin-gear:hover { opacity: 1; transform: rotate(90deg); }

        /* 2. ì‚­ì œ ë²„íŠ¼ (í‰ì†Œì—ëŠ” ìˆ¨ê¹€ - ê¸°ì¡´ ìœ ì§€) */
        .delete-btn {
            display: none; /* ê¸°ë³¸ì ìœ¼ë¡œ ì•ˆ ë³´ì„ */
            position: absolute; top: -10px; right: -10px;
            width: 25px; height: 25px;
            background: #ff5252; color: #fff;
            border: none; border-radius: 50%;
            font-weight: bold; font-size: 14px;
            cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            z-index: 10;
        }

        /* 3. ê´€ë¦¬ì ëª¨ë“œê°€ ì¼œì§€ë©´ ì‚­ì œ ë²„íŠ¼ì´ ë³´ì„! (ê¸°ì¡´ ìœ ì§€) */
        body.admin-mode .delete-btn {
            display: flex; align-items: center; justify-content: center;
        }
        
    </style>
</head>
<body>

    <div class="mini-player-wrapper">
        <div id="youtube-audio-source"></div>
        <div class="player-overlay"></div>
        <div class="player-controls">
            <div class="ctrl-btn" id="play-pause-btn" onclick="toggleMusic()">ğŸ”‡</div>
        </div>
    </div>

    <div class="admin-gear" onclick="adminLogin()">âš™ï¸</div>

    <div class="side-banner side-left"></div>
    <div class="side-banner side-right"></div>
    <div class="bg-overlay"></div>
    <div id="floating-container"></div>

    <div class="container">
        <div class="header-section">
            <h1>ãºã“ã¡ãƒ¼ãŸã€å’æ¥­ãŠã‚ã§ã¨ã†ï¼</h1>
            <p class="sub-message">
                æ­©ã‚“ã æ—¥ã€…ãŒã€åƒ•ã‚‰ã®æ˜Ÿåº§ã«ãªã‚‹ã€‚<br>
                <span class="micro-copy">ã“ã®ãƒšãƒ¼ã‚¸ã¯ã€åƒ•ã‚‰ã®è¶³è·¡ã‚’é›†ã‚ãŸå°ã•ãªãƒŸãƒ¥ãƒ¼ã‚¸ã‚¢ãƒ ã€‚</span>
            </p>
            <div class="divider"></div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="card-icon">ğŸŒ±</div> <div class="sparkle">âœ¨</div>
                    <span class="date-value">2023. 08. 28</span> <span class="stat-label">é…ä¿¡é–‹å§‹æ—¥</span>
                </div>
                <div class="stat-card">
                    <div class="card-icon">ğŸŠ</div> <div class="sparkle">âœ¨</div>
                    <span class="stat-value" id="total-days">0</span> <span class="stat-label">é…ä¿¡ã—ãŸæ—¥æ•°</span>
                </div>
                <div class="stat-card">
                    <div class="card-icon">ğŸ•°ï¸</div> <div class="sparkle">âœ¨</div>
                    <span class="stat-value" id="total-hours">0</span> <span class="stat-label">é…ä¿¡ã—ãŸæ™‚é–“</span>
                </div>
            </div>
            
            <div class="love-container-top">
                <button id="love-btn" class="carrot-btn">
                    ğŸ¥• æƒ³ã„ã‚’ä¼ãˆã‚‹ <span id="love-count">0</span>
                </button>
            </div>
        </div>

        <div class="album-section">
            <div class="album-container">
                <div class="album-track" id="album-track">
                    <div class="album-slide"><img src="images/album1.jpg" alt="1" onerror="this.src='https://placehold.co/800x450/333/FFF?text=No+Image'"><div class="album-caption">å°‘ã—ãšã¤ç©ã¿é‡ã­ã¦ããŸæ™‚é–“</div></div>
                    <div class="album-slide"><img src="images/album2.jpg" alt="2" onerror="this.src='https://placehold.co/800x450/333/FFF?text=No+Image'"><div class="album-caption">ç¬‘ã„åˆã£ãŸæ—¥ã€…</div></div>
                    <div class="album-slide"><img src="images/album3.jpg" alt="3" onerror="this.src='https://placehold.co/800x450/333/FFF?text=No+Image'"><div class="album-caption">ä¸€ç·’ã«ç¥ã£ãŸæ—¥ã€…</div></div>
                    <div class="album-slide"><img src="images/album4.jpg" alt="3" onerror="this.src='https://placehold.co/800x450/333/FFF?text=No+Image'"><div class="album-caption">ãºã“ã¡ãƒ¼ã¨éã”ã—ãŸæ—¥ã€…</div></div>
                    <div class="album-slide"><img src="images/album5.jpg" alt="5" onerror="this.src='https://placehold.co/800x450/333/FFF?text=No+Image'"><div class="album-caption">è¨˜æ†¶ã®ä¸­ã®æ—¥ã€…</div></div>
                    <div class="album-slide"><img src="images/album6.jpg" alt="6" onerror="this.src='https://placehold.co/800x450/333/FFF?text=No+Image'"><div class="album-caption">å¿˜ã‚Œã‚‰ã‚Œãªã„æ—¥ã€…</div></div>
                    <div class="album-slide"><img src="images/album7.jpg" alt="7" onerror="this.src='https://placehold.co/800x450/333/FFF?text=No+Image'"><div class="album-caption">ã‚ã‚ŠãŒã¨ã†</div></div>
                </div>
                <button class="album-btn prev-btn" onclick="moveSlide(-1)">â®</button>
                <button class="album-btn next-btn" onclick="moveSlide(1)">â¯</button>
            </div>
        </div>

        <div id="heatmap-section">
            <h2 class="section-title">
                ã“ã‚Œã¾ã§ä¸€ç·’ã«æ­©ã‚“ã è¨˜éŒ²ã‚’è¦‹ã‚‹<br>
                <span class="section-sub-title">(æ¬„ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ã€YouTubeã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã«ç§»å‹•)</span>
            </h2>

            <div class="heatmap-tabs">
                <button class="tab-btn active" onclick="updateHeatmap('all', this)">ã™ã¹ã¦è¡¨ç¤ºï¼ˆ3å¹´é–“ï¼‰</button>
                <button class="tab-btn" onclick="updateHeatmap('2024', this)">2024</button>
                <button class="tab-btn" onclick="updateHeatmap('2025', this)">2025</button>
                <button class="tab-btn" onclick="updateHeatmap('2026', this)">2026</button>
            </div>
            <div id="heatmap-chart"></div>
        </div>

       <div class="gallery-container">
        <h2 class="section-title">Fan Art Gallery</h2>
        <p style="text-align:center; color:#8b949e; margin-bottom:30px;">ãƒ•ã‚¡ãƒ³ãŸã¡ãŒè´ˆã£ã¦ãã‚ŒãŸå¤§åˆ‡ãªæ€ã„å‡ºë“¤</p>
        
        <div class="masonry-wall">
            <div class="art-card"><img src="fanart/kencha4.jpg" onerror="this.src='https://placehold.co/400x500/ffec99/333?text=FanArt+1'"><div class="art-info"><div class="art-title">é…”ã£ã±ã‚‰ã„ã‚ãƒãƒ å£ğŸ¤£</div><div class="art-author">ğŸ¨ KENCHA</div></div></div>
            <div class="art-card"><img src="fanart/sirafu.jpg" onerror="this.src='https://placehold.co/400x300/ffec99/333?text=FanArt+2'"><div class="art-info"><div class="art-title">ãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ğŸ¥•</div><div class="art-author">ğŸ¨ sirafu</div></div></div>
            <div class="art-card"><img src="fanart/namara.jpg" onerror="this.src='https://placehold.co/400x600/ffec99/333?text=FanArt+3'"><div class="art-info"><div class="art-title">2025å¹´ã®ç§ã®å†ç”Ÿãƒªã‚¹ãƒˆã€é…ä¿¡ã§çŸ¥ã£ãŸæ›²ã ã‚‰ã‘ğŸŠ</div><div class="art-author">ğŸ¨ ãªã¾ã‚‰</div></div></div>
            <div class="art-card"><img src="fanart/kencha5.jpg" onerror="this.src='https://placehold.co/400x400/ffec99/333?text=FanArt+4'"><div class="art-info"><div class="art-title">ãºã“è‰²é‰›ç­†</div><div class="art-author">ğŸ¨ KENCHA</div></div></div>
            <div class="art-card"><img src="fanart/kencha6.jpg" onerror="this.src='https://placehold.co/400x550/ffec99/333?text=FanArt+5'"><div class="art-info"><div class="art-title">ãºã“è‰²é‰›ç­†</div><div class="art-author">ğŸ¨ KENCHA</div></div></div>
            <div class="art-card"><img src="fanart/milkyway1.jpg" onerror="this.src='https://placehold.co/400x350/ffec99/333?text=FanArt+6'"><div class="art-info"><div class="art-title">å®®å´çœŒã§ğŸ˜„</div><div class="art-author">ğŸ¨ Milkyway</div></div></div>
            <div class="art-card"><img src="fanart/kencha1.jpg" onerror="this.src='https://placehold.co/400x400/ffec99/333?text=FanArt+4'"><div class="art-info"><div class="art-title">ãºã“ã¡ã¨ã‚¤ãƒ–</div><div class="art-author">ğŸ¨ KENCHA</div></div></div>
            <div class="art-card"><img src="fanart/kencha2.jpg" onerror="this.src='https://placehold.co/400x400/ffec99/333?text=FanArt+4'"><div class="art-info"><div class="art-title">ã„ã¤ã‚‚æ¥½ã—ãã¦ç™’ã•ã‚Œã‚‹é…ä¿¡</div><div class="art-author">ğŸ¨ KENCHA</div></div></div>
            <div class="art-card"><img src="fanart/kencha3.jpg" onerror="this.src='https://placehold.co/400x400/ffec99/333?text=FanArt+4'"><div class="art-info"><div class="art-title">ãºã“è‰²é‰›ç­†</div><div class="art-author">ğŸ¨ KENCHA</div></div></div>

        </div>
    </div>

    <div class="section-divider"></div>

    <div class="gallery-container">
        <h2 class="section-title">Pecotiita's Works</h2>
        <p style="text-align:center; color:#8b949e; margin-bottom:30px;">ãºã“ã¡ãƒ¼ãŸãŒè‡ªåˆ†ã§æã„ãŸä¸–ç•Œ</p>

        <div class="masonry-wall">
            <div class="art-card"><img src="art/pecotiita1.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+1'"><div class="art-info"><div class="art-title">ãŠã‚„ã™ã¿ğŸ’¤</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita2.jpg" onerror="this.src='https://placehold.co/400x600/c5f6fa/333?text=Work+2'"><div class="art-info"><div class="art-title">ç§æœãºã“ã¡æã„ã¦ã¿ãŸğŸŠğŸ¥•</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita3.jpg" onerror="this.src='https://placehold.co/400x300/c5f6fa/333?text=Work+3'"><div class="art-info"><div class="art-title">åˆæœŸè¡£è£…ã‚„ã£ã±ã‚Šè‰¯ãâ™¡</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita4.jpg" onerror="this.src='https://placehold.co/400x500/c5f6fa/333?text=Work+4'"><div class="art-info"><div class="art-title">ğŸ„Merry Christmas ğŸ„</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita5.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+5'"><div class="art-info"><div class="art-title">100æ›²æ­Œæ è€ä¹…ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸâ€¼ï¸</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita6.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+6'"><div class="art-info"><div class="art-title">ã¾ãŸæ˜æ—¥ ï½¡â™¡Â°</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita7.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+7'"><div class="art-info"><div class="art-title">æ˜¨æ—¥æã„ãŸè½æ›¸</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita8.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+8'"><div class="art-info"><div class="art-title">ã„ã¤ã‚‚ã¨é›°å›²æ°—é•ã†ãºã“ã¡ã‚’æã„ã¦ã¿ãŸã‚ˆğŸ–¤</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita9.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+9'"><div class="art-info"><div class="art-title">ãŠã‚„ã™ã¿ğŸ˜´</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita10.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+10'"><div class="art-info"><div class="art-title">ä¹…ã—ã¶ã‚Šã«ã‚¤ãƒ©ã‚¹ãƒˆæã„ã¦ã¿ãŸğŸ˜š</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita11.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+11'"><div class="art-info"><div class="art-title">ğŸ¥•â™¡ğŸ¥•</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita12.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+12'"><div class="art-info"><div class="art-title">ã‚­ãƒ©ã‚­ãƒ©ãŠç›®ã€…ğŸ¤©</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita13.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+13'"><div class="art-info"><div class="art-title">ãƒ¡ã‚¤ãƒ‰ãºã“ã¡</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita14.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+14'"><div class="art-info"><div class="art-title">ã¿ã‚“ãªã‚‚ã‚†ã£ãã‚Šã—ã¦ãã ã•ã„ğŸ˜Œ</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita15.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+15'"><div class="art-info"><div class="art-title">ãŠ—Twichãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼3000äººğŸŠ</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita16.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+16'"><div class="art-info"><div class="art-title">ãºã“è‰²é‰›ç­†</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita17.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+17'"><div class="art-info"><div class="art-title">ãºã“ã¡è½æ›¸ãã—ãŸğŸ¥•</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita18.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+18'"><div class="art-info"><div class="art-title">ãƒ¯ãƒ‹ãƒ³ã‚¸ãƒ³ï¼‘åŒ¹ç›®ğŸ‘€</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita19.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+19'"><div class="art-info"><div class="art-title">ãƒ¡ã‚¤ãƒ‰ãºã“ã¡</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita20.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+20'"><div class="art-info"><div class="art-title">å„ªã—ã„ãºã“ã¡ãƒ¼ãŸ</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita21.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+21'"><div class="art-info"><div class="art-title">ãƒ¯ãƒ³ãƒ¯ãƒ³ãƒ¯ãƒ³ã‹ãã‹ãâœï¸</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita22.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+22'"><div class="art-info"><div class="art-title">ã‚¤ãƒ–ãŸã‚“ã‹ãã‹ãâœï¸</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>
            <div class="art-card"><img src="art/pecotiita23.jpg" onerror="this.src='https://placehold.co/400x400/c5f6fa/333?text=Work+23'"><div class="art-info"><div class="art-title">å­¦ç”Ÿæœãºã“ã¡ã ã‚ˆğŸ¥•</div><div class="art-author">ğŸ–Œï¸ Pecotiita</div></div></div>

        </div>
    </div>

<div class="message-section">
        <h2 class="section-title">Message Wall</h2>
        <p style="text-align:center; color:#8b949e; margin-bottom:30px;">å’æ¥­ã‚’ç¥ã£ã¦ã€æ¸©ã‹ã„ä¸€è¨€ã‚’æ®‹ã—ã¦ãã ã•ã„ ğŸ’Œ</p>

        <div class="input-container">
            <input type="text" id="msg-name" placeholder="ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ " maxlength="10">
            <input type="text" id="msg-content" placeholder="å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆæœ€å¤§200æ–‡å­—ï¼‰" maxlength="200">
            <button id="msg-send-btn">ç™»éŒ²</button>
        </div>

        <div id="message-board" class="masonry-wall">
            </div>
    </div>

    <div id="video-modal">
        <div id="video-container"><iframe id="video-frame" allowfullscreen></iframe><video id="local-video" controls style="display:none;"></video></div>
        <button class="close-btn" onclick="closeModal()">ë‹«ê¸°</button>
    </div>

    <script src="./data.js"></script>
    <script src="https://www.youtube.com/iframe_api"></script>

<script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        // [ì¤‘ìš”] remove(ì‚­ì œ), onChildRemoved(ì‚­ì œê°ì§€) ê¸°ëŠ¥ì´ ì¶”ê°€ë¨
        import { getDatabase, ref, onValue, runTransaction, push, onChildAdded, remove, onChildRemoved } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // ğŸ”¥ [í•„ìˆ˜] ë³¸ì¸ì˜ Firebase ì„¤ì •ê°’ìœ¼ë¡œ ì±„ì›Œì£¼ì„¸ìš” ğŸ”¥
        const firebaseConfig = {
            apiKey: "AIzaSyBPf06S24ITUXs8nJSCzNKUMTVlbuO0Y5o",
            authDomain: "pecotiita-love.firebaseapp.com",
            databaseURL: "https://pecotiita-love-default-rtdb.firebaseio.com",
            projectId: "pecotiita-love",
            storageBucket: "pecotiita-love.firebasestorage.app",
            messagingSenderId: "192894613771",
            appId: "1:192894613771:web:7793b913c639104f018a0e",
            measurementId: "G-MY1NYP8V10"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        
        const loveRef = ref(db, 'carrot_count');
        const msgRef = ref(db, 'guestbook');

        // ------------------------------------------------
        // 1. [ê´€ë¦¬ì] ê¸°ëŠ¥
        // ------------------------------------------------
        
        // (1) ë¡œê·¸ì¸ í•¨ìˆ˜ (ì „ì—­ windowì— ë“±ë¡í•˜ì—¬ HTMLì—ì„œ í˜¸ì¶œ ê°€ëŠ¥í•˜ê²Œ í•¨)
        window.adminLogin = function() {
            const pw = prompt("ç®¡ç†è€…ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚:");
            if (pw === "0913") {
                alert("ç®¡ç†è€…ãƒ¢ãƒ¼ãƒ‰ONï¼ğŸ”§\nãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å‰Šé™¤ãƒœã‚¿ãƒ³ï¼ˆâœ•ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚");
                document.body.classList.add("admin-mode"); // CSSë¡œ ì‚­ì œ ë²„íŠ¼ ë³´ì´ê²Œ í•¨
            } else if (pw !== null) {
                alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚");
            }
        };

        // (2) ì‚­ì œ í•¨ìˆ˜
        window.deleteMessage = function(key) {
            if (confirm("æœ¬å½“ã«ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿï¼ˆå…ƒã«æˆ»ã™ã“ã¨ã¯ã§ãã¾ã›ã‚“ï¼‰")) {
                // íŒŒì´ì–´ë² ì´ìŠ¤ì—ì„œ í•´ë‹¹ keyë¥¼ ê°€ì§„ ë°ì´í„° ì‚­ì œ
                remove(ref(db, 'guestbook/' + key))
                    .then(() => alert("å‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚"))
                    .catch((error) => alert("å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚: " + error.message));
            }
        };

        // ------------------------------------------------
        // 2. [ë‹¹ê·¼ ë²„íŠ¼] ê¸°ëŠ¥
        // ------------------------------------------------
        onValue(loveRef, (snapshot) => {
            const data = snapshot.val() || 0;
            const countEl = document.getElementById('love-count');
            if(countEl) countEl.innerText = data.toLocaleString();
        });

        const btn = document.getElementById('love-btn');
        if(btn) {
            btn.addEventListener('click', (e) => {
                runTransaction(loveRef, (c) => (c || 0) + 1);
                createPopEmojis(e.clientX, e.clientY);
            });
        }

        // ------------------------------------------------
        // 3. [ë°©ëª…ë¡] ê¸°ëŠ¥
        // ------------------------------------------------
        
        // (1) ë©”ì‹œì§€ ë“±ë¡
        document.getElementById('msg-send-btn').addEventListener('click', () => {
            const nameInput = document.getElementById('msg-name');
            const contentInput = document.getElementById('msg-content');
            const name = nameInput.value.trim();
            const content = contentInput.value.trim();

            if (!name || !content) {
                alert("ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã¨å†…å®¹ã‚’ä¸¡æ–¹å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
                return;
            }

            push(msgRef, {
                name: name,
                content: content,
                date: new Date().toLocaleDateString(),
                timestamp: Date.now()
            });

            nameInput.value = '';
            contentInput.value = '';
        });

        // (2) ë©”ì‹œì§€ í‘œì‹œ (í™”ë©´ì— ì¶”ê°€)
        onChildAdded(msgRef, (data) => {
            const msg = data.val();
            const key = data.key; // ë°ì´í„°ì˜ ê³ ìœ  ID (ì‚­ì œí•  ë•Œ í•„ìš”)
            const board = document.getElementById('message-board');

            const card = document.createElement('div');
            const colors = ['note-yellow', 'note-blue', 'note-pink', 'note-green'];
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            
            card.className = `msg-card ${randomColor}`;
            card.id = `msg-${key}`; // ë‚˜ì¤‘ì— í™”ë©´ì—ì„œ ì§€ìš¸ ë•Œë¥¼ ìœ„í•´ ID ë¶€ì—¬
            
            card.innerHTML = `
                <button class="delete-btn" onclick="deleteMessage('${key}')">X</button>
                
                <div class="msg-header">
                    <span>From. ${escapeHtml(msg.name)}</span>
                    <span class="msg-date">${msg.date}</span>
                </div>
                <div class="msg-body">${escapeHtml(msg.content)}</div>
            `;

            board.prepend(card); 
        });

        // (3) [NEW] ì‹¤ì‹œê°„ ì‚­ì œ ë°˜ì˜ (DBì—ì„œ ì§€ì›Œì§€ë©´ í™”ë©´ì—ì„œë„ ìŠ‰ ì‚¬ë¼ì§)
        onChildRemoved(msgRef, (data) => {
            const element = document.getElementById(`msg-${data.key}`);
            if (element) {
                // ë¿… í•˜ê³  ì‚¬ë¼ì§€ëŠ” ì• ë‹ˆë©”ì´ì…˜
                element.style.transform = "scale(0)";
                setTimeout(() => element.remove(), 300);
            }
        });

        function escapeHtml(text) {
            if (!text) return "";
            return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
        }

        // ------------------------------------------------
        // [ìœ í‹¸] ì´ëª¨ì§€ íš¨ê³¼
        // ------------------------------------------------
        function createPopEmojis(x, y) {
            const emojis = ['ğŸ¥•', 'ğŸ§¡', 'ğŸ¥•', 'âœ¨']; 
            const count = 3 + Math.floor(Math.random() * 3); 
            for (let i = 0; i < count; i++) {
                const el = document.createElement('div');
                el.className = 'pop-emoji';
                el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
                const randomX = (Math.random() - 0.5) * 100 + 'px'; 
                const randomRot = (Math.random() - 0.5) * 60 + 'deg'; 
                el.style.setProperty('--x-move', randomX);
                el.style.setProperty('--rot', randomRot);
                el.style.left = x + 'px';
                el.style.top = y + 'px';
                document.body.appendChild(el);
                setTimeout(() => el.remove(), 1000);
            }
        }
    </script>
    <script>
        // ----------------------------------------------------
        // [YouTube BGM] ì˜¤ë¥˜ 153 ë°©ì§€ & ì •ì±… ì¤€ìˆ˜
        // ----------------------------------------------------
        var player;
        var isPlayerReady = false;

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-audio-source', {
                host: 'https://www.youtube-nocookie.com',
                height: '200', width: '200',
                videoId: 'lv5R6C3hz54', 
                playerVars: {
                    'autoplay': 0, 'controls': 0, 'disablekb': 1, 'fs': 0, 
                    'loop': 1, 'playlist': 'lv5R6C3hz54', 'playsinline': 1,
                    'origin': window.location.origin
                },
                events: { 'onReady': onPlayerReady }
            });
        }

        function onPlayerReady(event) {
            isPlayerReady = true;
            event.target.setVolume(50);
        }

        function toggleMusic() {
            if (!isPlayerReady || !player) return;
            const btn = document.getElementById('play-pause-btn');
            const playerState = player.getPlayerState();

            if (playerState === 1) { 
                player.pauseVideo();
                btn.innerText = 'ğŸ”‡';
                btn.classList.remove('music-on');
            } else { 
                player.playVideo();
                btn.innerText = 'ğŸ”Š';
                btn.classList.add('music-on');
            }
        }

        document.body.addEventListener('click', function() {
            if (isPlayerReady && player && player.getPlayerState() !== 1) {
                player.playVideo();
                const btn = document.getElementById('play-pause-btn');
                btn.innerText = 'ğŸ”Š';
                btn.classList.add('music-on');
            }
        }, { once: true });


        // ----------------------------------------------------
        // [UI ë¡œì§] ìŠ¬ë¼ì´ë”, ì• ë‹ˆë©”ì´ì…˜
        // ----------------------------------------------------
        
        let slideIndex = 0;
        const track = document.getElementById('album-track');
        let slides = document.querySelectorAll('.album-slide');
        function moveSlide(n) {
            slides = document.querySelectorAll('.album-slide');
            if(slides.length === 0) return;
            slideIndex += n;
            if (slideIndex >= slides.length) slideIndex = 0;
            if (slideIndex < 0) slideIndex = slides.length - 1;
            track.style.transform = `translateX(-${slideIndex * 100}%)`;
        }
        let autoSlide = setInterval(() => moveSlide(1), 5000);
        document.querySelector('.album-container').addEventListener('mouseenter', () => clearInterval(autoSlide));
        document.querySelector('.album-container').addEventListener('mouseleave', () => autoSlide = setInterval(() => moveSlide(1), 5000));

        function animateCounter(id, end) {
            const obj = document.getElementById(id);
            let start = 0; const duration = 8000; 
            const startTime = performance.now();
            function step(now) {
                const progress = Math.min((now - startTime) / duration, 1);
                const ease = 1 - Math.pow(1 - progress, 4);
                obj.innerText = Math.floor(start + (end - start) * ease).toLocaleString();
                if (progress < 1) {
                    requestAnimationFrame(step);
                } else {
                    const sparkle = obj.parentElement.querySelector('.sparkle');
                    if(sparkle) sparkle.classList.add('animate');
                }
            }
            requestAnimationFrame(step);
        }
// ----------------------------------------------------
        // [í†µê³„ ì• ë‹ˆë©”ì´ì…˜] data.js ê¸°ë°˜ ìë™ ê³„ì‚°
        // ----------------------------------------------------
        function animateCounter(id, end) {
            const obj = document.getElementById(id);
            let start = 0; const duration = 1200; 
            const startTime = performance.now();
            function step(now) {
                const progress = Math.min((now - startTime) / duration, 1);
                const ease = 1 - Math.pow(1 - progress, 4);
                obj.innerText = Math.floor(start + (end - start) * ease).toLocaleString();
                if (progress < 1) {
                    requestAnimationFrame(step);
                } else {
                    const sparkle = obj.parentElement.querySelector('.sparkle');
                    if(sparkle) sparkle.classList.add('animate');
                }
            }
            requestAnimationFrame(step);
        }

        // [NEW] data.js ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ìë™ìœ¼ë¡œ ë‚ ì§œ/ì‹œê°„ ê³„ì‚°
        if (typeof heatmapData !== 'undefined') {
            // 1. ë°©ì†¡í•œ ë‚  = ë°ì´í„° ë°°ì—´ì˜ ê¸¸ì´ (ì´ ë©°ì¹  ë°©ì†¡í–ˆëŠ”ì§€)
            const totalDays = heatmapData.length;

            // 2. ë°©ì†¡í•œ ì‹œê°„ = ë°ì´í„°ì˜ [1]ë²ˆ ì¸ë±ìŠ¤(ë¶„)ë¥¼ ëª¨ë‘ í•©ì‚° í›„ ì‹œê°„ìœ¼ë¡œ í™˜ì‚°
            // item[1]ì€ data.jsì˜ ["ë‚ ì§œ", ë¶„, ...] ì—ì„œ 'ë¶„'ì„ ì˜ë¯¸í•¨
            const totalMinutes = heatmapData.reduce((sum, item) => sum + item[1], 0);
            const totalHours = Math.round(totalMinutes / 60);

            // ê³„ì‚°ëœ ê°’ìœ¼ë¡œ ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰
            animateCounter("total-days", totalDays);
            animateCounter("total-hours", totalHours);
        } else {
            // ë°ì´í„°ê°€ ì—†ì„ ê²½ìš° 0ìœ¼ë¡œ í‘œì‹œ (í˜¹ì€ ê¸°ë³¸ê°’)
            animateCounter("total-days", 0);
            animateCounter("total-hours", 0);
        }
// ----------------------------------------------------
        // [FIX] íˆíŠ¸ë§µ ì°¨íŠ¸ ë¡œì§ (í´ë¦­ ì •í™•ë„ ê°œì„  & íƒ€ì´í‹€ ì¶”ê°€ ëŒ€ì‘)
        // ----------------------------------------------------
        let chartInstance = null;
        
        if (typeof heatmapData !== 'undefined') {
            const btn = document.querySelector('.tab-btn.active');
            setTimeout(() => updateHeatmap('all', btn), 100);
        }

        window.updateHeatmap = function(mode, btn) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if(btn) btn.classList.add('active');

            const chartDom = document.getElementById('heatmap-chart');
            
            // ë†’ì´ ì„¤ì •
            if (mode === 'all') { chartDom.style.height = '750px'; } 
            else { chartDom.style.height = '240px'; }

            // ê¸°ì¡´ ì°¨íŠ¸ ì‚­ì œ í›„ ìƒˆë¡œ ìƒì„± (ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€ ë° ë¦¬ì‚¬ì´ì¦ˆ ë²„ê·¸ í•´ê²°)
            if (chartInstance) { chartInstance.dispose(); }
            chartInstance = echarts.init(chartDom, 'dark');

            let option = {
                backgroundColor: 'transparent',
                tooltip: { 
                    position: 'top', // íˆ´íŒì´ ì†ê°€ë½/ë§ˆìš°ìŠ¤ ê°€ë¦¬ì§€ ì•Šê²Œ ìœ„ë¡œ
                    backgroundColor: 'rgba(0,0,0,0.9)', 
                    borderColor: '#FFD700',
                    textStyle: { color: '#fff' }
                },
                visualMap: { 
                    min: 1, max: 200, show: false, 
                    inRange: { color: ['#2e2600', '#8a6d00', '#FFD700'] },
                    dimension: 1 
                },
                series: []
            };

// ----------------------------------------
            // [A] ì „ì²´ë³´ê¸° (3ë…„ì¹˜ ì—°ë„ë³„ ì ì¸µ View)
            // ----------------------------------------
            if (mode === 'all') {
                option.visualMap.max = 200;
                option.visualMap.dimension = 1;

                option.tooltip.formatter = p => {
                    // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ í‘œì‹œ ì•ˆ í•¨
                    if (!p.value) return ''; 
                    
                    // [ìˆ˜ì •] ğŸ¬(p.value[3]) ë¶€ë¶„ ì‚­ì œ -> ì‹œê°„ ì¤‘ë³µ í‘œì‹œ ë°©ì§€
                    // â±ï¸ ìë™ ê³„ì‚°ëœ ì‹œê°„ë§Œ ê¹”ë”í•˜ê²Œ í‘œì‹œ
                    return `<b>${p.value[0]}</b><br>â±ï¸ ${Math.floor(p.value[1]/60)}æ™‚é–“ ${p.value[1]%60}åˆ†`;
                };
                
                // ë‹¬ë ¥ ê°„ê²© ë°°ì¹˜ (50 -> 280 -> 510)
                option.calendar = [
                    { top: 50, range: '2024', cellSize: ['auto', 20], itemStyle: { borderWidth: 4, borderColor: '#161b22', borderRadius: 5 }, dayLabel: { nameMap: 'ko', color: '#8b949e' }, monthLabel: { nameMap: 'ko', color: '#fff', fontWeight: 'bold' } },
                    { top: 270, range: '2025', cellSize: ['auto', 20], itemStyle: { borderWidth: 4, borderColor: '#161b22', borderRadius: 5 }, dayLabel: { nameMap: 'ko', color: '#8b949e' }, monthLabel: { nameMap: 'ko', color: '#fff', fontWeight: 'bold' } },
                    { top: 470, range: '2026', cellSize: ['auto', 20], itemStyle: { borderWidth: 4, borderColor: '#161b22', borderRadius: 5 }, dayLabel: { nameMap: 'ko', color: '#8b949e' }, monthLabel: { nameMap: 'ko', color: '#fff', fontWeight: 'bold' } }
                ];

                option.series = [
                    { type: 'heatmap', coordinateSystem: 'calendar', calendarIndex: 0, data: heatmapData.filter(d => d[0].startsWith('2024')) },
                    { type: 'heatmap', coordinateSystem: 'calendar', calendarIndex: 1, data: heatmapData.filter(d => d[0].startsWith('2025')) },
                    { type: 'heatmap', coordinateSystem: 'calendar', calendarIndex: 2, data: heatmapData.filter(d => d[0].startsWith('2026')) }
                ];

            } 
            // ----------------------------------------
            // [B] ì—°ë„ë³„ ë³´ê¸° (1ë…„ì¹˜)
            // ----------------------------------------
            else {
                option.visualMap.max = 200;
                option.visualMap.dimension = 1;

                option.tooltip.formatter = p => {
                    if (!p.value) return '';
                    // [ìˆ˜ì •] ì—¬ê¸°ë„ ì‹œê°„ ì¤‘ë³µ ì œê±°
                    return `<b>${p.value[0]}</b><br>â±ï¸ ${Math.floor(p.value[1]/60)}ì‹œê°„ ${p.value[1]%60}ë¶„`;
                };
                
                option.calendar = { 
                    top: 40, range: mode, 
                    cellSize: ['auto', 20], 
                    itemStyle: { borderWidth: 4, borderColor: '#161b22', borderRadius: 5 }, 
                    dayLabel: { nameMap: 'ko', color: '#8b949e' }, 
                    monthLabel: { 
                        nameMap: ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'], 
                        color: '#fff', 
                        fontWeight: 'bold',
                        fontFamily: 'Noto Sans JP' /* (ì„ íƒ) ì¼ë³¸ì–´ í°íŠ¸ê°€ ë” ì˜ˆì©ë‹ˆë‹¤ */},
                yearLabel: { show: false }
                };
                
                option.series = [{ 
                    type: 'heatmap', 
                    coordinateSystem: 'calendar', 
                    data: heatmapData.filter(d => d[0].startsWith(mode)) 
                }];
            }

            // ì˜µì…˜ ì ìš©
            chartInstance.setOption(option);

            // [ì¤‘ìš”] í´ë¦­ ì´ë²¤íŠ¸ ì •í™•ë„ ìˆ˜ì •
            // ê¸°ì¡´ì—ëŠ” mode !== 'all' ì¡°ê±´ ë•Œë¬¸ì— ì „ì²´ë³´ê¸°ì—ì„œ í´ë¦­ì´ ì•ˆ ë˜ì—ˆìŒ -> ì¡°ê±´ ì‚­ì œ
            // p.data[2]ì— ì˜ìƒ IDê°€ ìˆëŠ”ì§€ í™•ì¸
            chartInstance.on('click', function(p) {
                if (p.data && p.data[2]) {
                    openModal(p.data[2]);
                }
            });

            setTimeout(() => { chartInstance.resize(); }, 50);
        };

        window.addEventListener('resize', () => { if(chartInstance) chartInstance.resize(); });

        document.addEventListener('mousemove', e => {
            if (Date.now() % 5 !== 0) return;
            const t = document.createElement('div');
            t.className = 'trail-emoji'; t.innerText = Math.random() > 0.5 ? 'ğŸŠ' : 'ğŸ¥•';
            t.style.left = e.pageX + 'px'; t.style.top = e.pageY + 'px';
            const rotate = (Math.random() - 0.5) * 60;
            t.style.transform = `translate(-50%, -50%) rotate(${rotate}deg)`;
            document.body.appendChild(t); setTimeout(() => t.remove(), 1000);
        });

        function createFloatingItems() {
            const container = document.getElementById('floating-container');
            const icons = ['ğŸ§¡', 'ğŸ¥•', 'âœ¨', 'ğŸŠ', 'ğŸ’›', 'ğŸ’Œ'];
            for (let i = 0; i < 20; i++) {
                const item = document.createElement('div');
                item.className = 'floating-item';
                item.innerText = icons[Math.floor(Math.random()*icons.length)];
                item.style.left = Math.random() * 100 + 'vw';
                item.style.fontSize = (Math.random() * 25 + 15) + 'px';
                item.style.animationDuration = (Math.random() * 15 + 15) + 's';
                item.style.animationDelay = `-${Math.random() * 20}s`;
                container.appendChild(item);
            }
        }
        createFloatingItems();

        function openModal(id) {
            const m = document.getElementById('video-modal');
            const f = document.getElementById('video-frame');
            const v = document.getElementById('local-video');
            m.style.display = 'flex';
            if(id.includes('.mp4')) { f.style.display='none'; v.style.display='block'; v.src=id; v.play(); }
            else { v.style.display='none'; f.style.display='block'; f.src=`https://www.youtube.com/embed/${id}?autoplay=1`; }
        }
        function closeModal() {
            document.getElementById('video-modal').style.display='none';
            document.getElementById('video-frame').src='';
            const v = document.getElementById('local-video'); v.pause(); v.src='';
        }

        let count = parseInt(localStorage.getItem('love') || 0);
        document.getElementById('love-count').innerText = count.toLocaleString();
        document.getElementById('love-btn').onclick = (e) => {
            count++; localStorage.setItem('love', count);
            document.getElementById('love-count').innerText = count.toLocaleString();
            const p = document.createElement('div'); p.className='pop-heart'; p.innerText='ğŸ§¡';
            p.style.left = e.pageX+'px'; p.style.top = e.pageY+'px';
            document.body.appendChild(p); setTimeout(()=>p.remove(), 1000);
        };
    </script>
</body>
</html>












































